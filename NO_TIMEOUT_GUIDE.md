# üöÄ –ò–ú–ü–û–†–¢ –ë–ï–ó –û–ì–†–ê–ù–ò–ß–ï–ù–ò–ô TIMEOUT

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û

–ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç **–ü–û–õ–ù–û–°–¢–¨–Æ –ë–ï–ó –û–ì–†–ê–ù–ò–ß–ï–ù–ò–ô –ü–û –í–†–ï–ú–ï–ù–ò**.

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:

1. **ProductsImport.php**
   - ‚úÖ `set_time_limit(0)` - –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤—Ä–µ–º–µ–Ω–∏
   - ‚úÖ `memory_limit = -1` - –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–∞–º—è—Ç–∏
   - ‚úÖ –°–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–∞ –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ
   - ‚úÖ –û—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ –∫–∞–∂–¥—ã–µ 10 —Å—Ç—Ä–æ–∫

2. **DownloadProductImagesJob.php**
   - ‚úÖ `timeout = 0` - –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
   - ‚úÖ `failOnTimeout = false` - –Ω–µ –ø–∞–¥–∞—Ç—å –ø—Ä–∏ —Ç–∞–π–º–∞—É—Ç–µ
   - ‚úÖ –°–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–∞ –Ω–∞ –∫–∞–∂–¥–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏

3. **DownloadCategoryPhotoJob.php**
   - ‚úÖ `timeout = 0` - –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
   - ‚úÖ `failOnTimeout = false` - –Ω–µ –ø–∞–¥–∞—Ç—å –ø—Ä–∏ —Ç–∞–π–º–∞—É—Ç–µ

4. **config/queue.php**
   - ‚úÖ `retry_after = 0` - –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –¥–ª—è database queue
   - ‚úÖ `retry_after = 0` - –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –¥–ª—è redis queue

5. **public/.htaccess**
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PHP –¥–ª—è Apache
   - ‚úÖ `max_execution_time = 0`
   - ‚úÖ `memory_limit = -1`

6. **public/.user.ini**
   - ‚úÖ –°–æ–∑–¥–∞–Ω –¥–ª—è FastCGI/PHP-FPM —Ö–æ—Å—Ç–∏–Ω–≥–æ–≤
   - ‚úÖ –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

---

## üìã –ß–¢–û –ó–ê–ì–†–£–ó–ò–¢–¨ –ù–ê –•–û–°–¢–ò–ù–ì

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:

```
app/Console/Kernel.php
app/Imports/ProductsImport.php
app/Jobs/DownloadProductImagesJob.php
app/Jobs/DownloadCategoryPhotoJob.php
config/queue.php
public/.htaccess
public/.user.ini
public/check-php.php (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ)
```

---

## üîß –ù–ê–°–¢–†–û–ô–ö–ê –•–û–°–¢–ò–ù–ì–ê

### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å CRON –∑–∞–¥–∞—á–∏

**–£–¥–∞–ª–∏—Ç—å:**
```
php artisan session:clear
```

**–î–æ–±–∞–≤–∏—Ç—å:**
```bash
# –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ Laravel
* * * * * cd /home/g/gamechann2/western-panda_ru && php artisan schedule:run >> /dev/null 2>&1

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—á–µ—Ä–µ–¥–∏ (–ë–ï–ó –¢–ê–ô–ú–ê–£–¢–ê!)
* * * * * cd /home/g/gamechann2/western-panda_ru && php artisan queue:work database --stop-when-empty --tries=3 --timeout=0 >> /dev/null 2>&1
```

‚ö†Ô∏è **–í–ê–ñ–ù–û:** `--timeout=0` = –ë–ï–ó –û–ì–†–ê–ù–ò–ß–ï–ù–ò–ô!

---

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PHP

**–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
```
https://your-domain.com/check-php.php
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- ‚úÖ `max_execution_time = 0`
- ‚úÖ `max_input_time = 0`
- ‚úÖ `memory_limit = -1` (–∏–ª–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ)

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –∫—Ä–∞—Å–Ω–æ–µ - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å.

---

### 3. –í–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PHP –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ

#### –í–∞—Ä–∏–∞–Ω—Ç A: .htaccess (Apache + mod_php)

–§–∞–π–ª `public/.htaccess` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç:
```apache
php_value max_execution_time 0
php_value max_input_time 0
php_value memory_limit -1
```

‚úÖ **–ü—Ä–æ—Å—Ç–æ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª!**

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: .user.ini (FastCGI/PHP-FPM)

–§–∞–π–ª `public/.user.ini` —É–∂–µ —Å–æ–∑–¥–∞–Ω:
```ini
max_execution_time = 0
max_input_time = 0
memory_limit = -1
```

‚úÖ **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ –ø–∞–ø–∫—É public_html!**

–ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –≤:
- `.user.ini`
- `php.ini`
- `ini.php`

(–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ö–æ—Å—Ç–∏–Ω–≥–∞)

#### –í–∞—Ä–∏–∞–Ω—Ç –í: –ü–∞–Ω–µ–ª—å —Ö–æ—Å—Ç–∏–Ω–≥–∞

–ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:
- "PHP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
- "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ PHP"
- "php.ini —Ä–µ–¥–∞–∫—Ç–æ—Ä"
- "–í—ã–±–æ—Ä –≤–µ—Ä—Å–∏–∏ PHP"

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```
max_execution_time = 0
max_input_time = 0
memory_limit = -1
```

‚ö†Ô∏è –ï—Å–ª–∏ `-1` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞–∫—Å–∏–º—É–º: `999999`

---

### 4. –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
cd /home/g/gamechann2/western-panda_ru
php artisan config:clear
php artisan cache:clear
php artisan queue:restart
php artisan import:cleanup --all
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PHP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```bash
php -r "echo 'max_execution_time: ' . ini_get('max_execution_time') . PHP_EOL;"
php -r "echo 'memory_limit: ' . ini_get('memory_limit') . PHP_EOL;"
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
max_execution_time: 0
memory_limit: -1
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—á–µ—Ä–µ–¥—å

```bash
php artisan import:status
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

```bash
tail -n 50 storage/logs/laravel.log
```

–ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–æ timeout –∏–ª–∏ memory.

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢

–¢–µ–ø–µ—Ä—å –∏–º–ø–æ—Ä—Ç:

‚úÖ **–ù–ï –û–ì–†–ê–ù–ò–ß–ï–ù** –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è  
‚úÖ **–ù–ï –û–ì–†–ê–ù–ò–ß–ï–ù** –ø–æ –ø–∞–º—è—Ç–∏  
‚úÖ **–ù–ï –ü–ê–î–ê–ï–¢** –ø—Ä–∏ –¥–æ–ª–≥–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞  
‚úÖ **–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò** –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö  
‚úÖ **–°–ë–†–ê–°–´–í–ê–ï–¢** —Ç–∞–π–º–µ—Ä –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ  
‚úÖ **–û–ß–ò–©–ê–ï–¢** –ø–∞–º—è—Ç—å –∫–∞–∂–¥—ã–µ 10 —Å—Ç—Ä–æ–∫  

---

## üìä –ü–ê–†–ê–ú–ï–¢–†–´ –î–û –ò –ü–û–°–õ–ï

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|----------|------|-------|
| max_execution_time | 180 —Å–µ–∫ | **0 (‚àû)** |
| max_input_time | 180 —Å–µ–∫ | **0 (‚àû)** |
| memory_limit | 512M | **-1 (‚àû)** |
| Job timeout | 180 —Å–µ–∫ | **0 (‚àû)** |
| retry_after | 90 —Å–µ–∫ | **0 (‚àû)** |
| failOnTimeout | true | **false** |

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### –î–ª—è shared —Ö–æ—Å—Ç–∏–Ω–≥–∞:

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Å—Ç–∏–Ω–≥–∏ **–Ω–µ —Ä–∞–∑—Ä–µ—à–∞—é—Ç** `timeout = 0` –∏–ª–∏ `memory_limit = -1`.

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
```ini
max_execution_time = 999999
max_input_time = 999999
memory_limit = 2048M
```

### –ï—Å–ª–∏ –∏–º–ø–æ—Ä—Ç –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã —Ö–æ—Å—Ç–∏–Ω–≥–∞** - –≤–æ–∑–º–æ–∂–Ω–æ –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ QUEUE_CONNECTION=sync** - –æ—Ç–∫–ª—é—á–∞–µ—Ç —Ñ–æ–Ω–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
3. **–†–∞–∑–±–∏–≤–∞–π—Ç–µ —Ñ–∞–π–ª—ã** - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ 20-30 —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞ —Ä–∞–∑
4. **–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ö–æ—Å—Ç–∏–Ω–≥–∞** - –ø–æ–ø—Ä–æ—Å–∏—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç—ã

---

## üÜò –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞: "PHP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã: `chmod 644 .htaccess .user.ini`
2. –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ `.user.ini` –≤ `php.ini`
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ö–æ—Å—Ç–∏–Ω–≥–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "Queue worker –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
php artisan queue:restart
php artisan queue:work --timeout=0 --once
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ò–º–ø–æ—Ä—Ç –≤–∏—Å–∏—Ç –Ω–∞ –æ–¥–Ω–æ–º —Ç–æ–≤–∞—Ä–µ"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
php artisan import:cleanup --all
php artisan queue:failed
php artisan queue:retry all
```

---

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ:

```bash
# –í—ã–≤–æ–¥ check-php.php (—Å–∫—Ä–∏–Ω—à–æ—Ç –∏–ª–∏ —Ç–µ–∫—Å—Ç)
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PHP
php -i | grep -E "max_execution_time|memory_limit|max_input_time"

# –°—Ç–∞—Ç—É—Å –∏–º–ø–æ—Ä—Ç–∞
php artisan import:status --detailed

# –õ–æ–≥–∏
tail -n 200 storage/logs/laravel.log
```

---

## üéâ –ì–û–¢–û–í–û!

–¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å **–õ–Æ–ë–û–ï –ö–û–õ–ò–ß–ï–°–¢–í–û** —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏!

**–î–∞—Ç–∞:** 26 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 3.0 - NO TIMEOUT EDITION  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
