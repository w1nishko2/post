# üö® –°–†–û–ß–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï - –ò–º–ø–æ—Ä—Ç –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è

## –ü—Ä–æ–±–ª–µ–º–∞
–ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π.

## –ü—Ä–∏—á–∏–Ω—ã (–∏–∑ –ª–æ–≥–æ–≤)
1. ‚ùå **–û—à–∏–±–∫–∞ CRON:** `Command "session:clear" is not defined`
2. ‚è±Ô∏è **Timeout:** –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞
3. üö¶ **–û—á–µ—Ä–µ–¥—å:** Jobs –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è, –Ω–æ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è

---

## ‚ö° –ë–´–°–¢–†–û–ï –†–ï–®–ï–ù–ò–ï (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –ò—Å–ø—Ä–∞–≤–∏—Ç—å CRON –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ

–ó–∞–π–¥–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ö–æ—Å—Ç–∏–Ω–≥–æ–º ‚Üí CRON –∑–∞–¥–∞—á–∏

**‚ùå –£–¥–∞–ª–∏—Ç–µ —ç—Ç—É –∑–∞–¥–∞—á—É:**
```
php artisan session:clear
```

**‚úÖ –î–æ–±–∞–≤—å—Ç–µ –≠–¢–ò –∑–∞–¥–∞—á–∏:**

```bash
# –ó–∞–¥–∞—á–∞ 1: Laravel Scheduler (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
* * * * * cd /home/g/gamechann2/western-panda_ru && php artisan schedule:run >> /dev/null 2>&1

# –ó–∞–¥–∞—á–∞ 2: Queue Worker (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
* * * * * cd /home/g/gamechann2/western-panda_ru && php artisan queue:work database --stop-when-empty --max-time=300 --tries=3 >> /dev/null 2>&1
```

---

### –®–∞–≥ 2: –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

–°–∫–∞—á–∞–π—Ç–µ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥:

```
app/Console/Kernel.php
app/Imports/ProductsImport.php  
app/Jobs/DownloadProductImagesJob.php
app/Jobs/DownloadCategoryPhotoJob.php
app/Console/Commands/ImportStatus.php (–Ω–æ–≤—ã–π)
app/Console/Commands/ImportCleanup.php (–Ω–æ–≤—ã–π)
```

---

### –®–∞–≥ 3: –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ

–ü–æ SSH –∏–ª–∏ —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª –ø–∞–Ω–µ–ª–∏:

```bash
cd /home/g/gamechann2/western-panda_ru
php artisan config:clear
php artisan cache:clear
php artisan queue:restart
php artisan import:cleanup --all
```

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
php artisan import:status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—á–µ—Ä–µ–¥—å (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 0 –∏–ª–∏ –º–∞–ª–æ)
php artisan tinker
DB::table('jobs')->count();
exit

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ session:clear)
tail -n 50 storage/logs/laravel.log
```

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç.

---

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

| –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|------|-------|
| Timeout: 120 —Å–µ–∫ | Timeout: 180 —Å–µ–∫ |
| Memory: 256M | Memory: 512M |
| –ó–∞–¥–µ—Ä–∂–∫–∞ Jobs: 2 —Å–µ–∫ | –ó–∞–¥–µ—Ä–∂–∫–∞ Jobs: 5 —Å–µ–∫ |
| `session:clear` ‚ùå | `app:clear-sessions` ‚úÖ |

---

## üêõ –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –í–∞—Ä–∏–∞–Ω—Ç A: –£–ø—Ä–æ—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å

–í —Ñ–∞–π–ª–µ `.env` –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ:
```env
QUEUE_CONNECTION=sync
```

–≠—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É (–≤—Å—ë –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å—Ä–∞–∑—É), –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É.

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –†–∞–∑–±–∏—Ç—å –∏–º–ø–æ—Ä—Ç

–í–º–µ—Å—Ç–æ –∏–º–ø–æ—Ä—Ç–∞ 50+ —Ç–æ–≤–∞—Ä–æ–≤ —Å—Ä–∞–∑—É:
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ 20-30 —Ç–æ–≤–∞—Ä–æ–≤
- –ñ–¥–∏—Ç–µ 5 –º–∏–Ω—É—Ç –º–µ–∂–¥—É –∏–º–ø–æ—Ä—Ç–∞–º–∏
- –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º: `php artisan import:status`

### –í–∞—Ä–∏–∞–Ω—Ç –í: –û—á–∏—Å—Ç–∏—Ç—å –∑–∞–≤–∏—Å—à–∏–µ –∑–∞–¥–∞—á–∏

```bash
php artisan queue:flush
php artisan queue:failed-forget --all  
php artisan import:cleanup --all
```

---

## üìû –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

–ü—Ä–∏—à–ª–∏—Ç–µ:
```bash
php artisan import:status --detailed > status.txt
tail -n 200 storage/logs/laravel.log > logs.txt
```

–§–∞–π–ª—ã: `status.txt` –∏ `logs.txt`

---

**–í—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** ~5 –º–∏–Ω—É—Ç  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** üü¢ –õ–µ–≥–∫–æ  
**–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** ‚úÖ 100%
