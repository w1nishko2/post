https://api.forum-auto.ru/docs/index.php
API Forum-Auto
Программный интерфейс (API) Forum-Auto предназначен для автоматизированного обмена заказами и веб-проценки ассортимента.

Подключение
После подключения к сервису вы получаете логин и пароль, которые необходимо передавать в каждом запросе.

Формат взаимодействия
Данные передаются в кодировке UTF-8.

Сервис доступен только по протоколу HTTPS.

SOAP/XML
Первая версия API Forum-Auto работает по протоколу обмена SOAP/XML. Входные и выходные структуры данных передаются в теле запроса и ответа.

Адрес сервиса: https://api.forum-auto.ru/soap

Для сервиса существует описание на языке WSDL (Web Services Description Language), в котором представлены методы, входные и выходные структуры данных, типы данных и другое.

Адрес WSDL: https://api.forum-auto.ru/wsdl

Пример работы с сервисом на PHP.

REST/JSON
Вторая версия веб-сервиса построена на REST-принципах.

Запрос от клиента к серверу выполняется методом GET https://api.forum-auto.ru/v2/имя_метода?параметры, тело ответа всегда в формате JSON.

Пример вызова метода clientInfo: https://api.forum-auto.ru/v2/clientinfo?login=ЛОГИН&pass=ПАРОЛЬ

Обработка ошибок
При вызове методов возможно возникновение ошибок и предупреждений.

Они возвращаются в форме ошибки SOAP (элемент XML Fault).

Переменная	Тип	Описание
FaultCode	integer	Числовой код ошибки или предупреждения.
FaultString	string	Текст сообщения об ошибке или предупреждения.
Detail	string	Подробное описание ошибки или предупреждения.
Описание всех ошибок можно посмотреть в разделе Коды ошибок



https://api.forum-auto.ru/docs/clientinfo.php

Информация о клиенте. Метод clientInfo.
Имя метода
clientInfo
Описание
Возвращает информацию о клиенте. Наличие доступа к функциям, лимиты и пр.

Ниже приведено описание параметров.

Входные данные
Параметр	Тип	Описание
login	String	Логин
pass	String	Пароль
Результирующие данные (многомерный массив).
Параметр	Тип	Описание
name	String	Параметр
value	String	Значение параметра





https://api.forum-auto.ru/docs/addgoodstoorder.php
Создание и изменение заказа. Метод addGoodsToOrder.
Имя метода
addGoodsToOrder
Описание
Добавление товара в заказ и изменение его кол-ва (в т.ч. удаление).

Если товар с таким eid уже есть, то его кол-во будет изменено в соответсвии с последним запросом.

Для удаления позиции передайте ее tid, eid и num = 0.

Ниже приведено описание параметров.

Входные данные
Параметр	Тип	Описание
login	String	Логин
pass	String	Пароль
tid	String	ИД товара в нашей системе. Обратите внимание: теперь это текстовое поле!
num	Integer	Кол-во товара
eid	Integer	ИД товарной строки заказа в вашей системе. Если не передали, будет сгенерен автоматически. Если товар с таким eid уже есть, то кол-во будет изменено в соотв. с последним запросом.
eoid	Integer	ИД заказа в вашей системе. Необязательное поле.
Результирующие данные.
Возвращается информация по созданному заказу с его товарным составом.
Результирующие данные аналогичны методу "Информация о заказе(ах)".
Подробнее см. Информация о заказе(ах).



https://api.forum-auto.ru/docs/listorders.php
Информация о заказе(ах). Метод listOrders.
Имя метода
listOrders
Описание
Возвращает заказ(ы) с товарным составом.

Ниже приведено описание параметров.

Входные данные
Параметр	Тип	Описание
login	String	Логин
pass	String	Пароль
did	Integer	ИД заказа. Оставьте это поле пустым, либо передайте 0, если хотите посмотреть список всех активных заказов клиента. (за исключением аннулированных и выданных)
Результирующие данные (многомерный массив).
Параметр	Тип	Описание
Заголовок документа
did	Integer	ИД заказа
dtc	String	Дата создания заказа
nr	String	Номер документа
status	String	Название статуса заказа (таблица статусов ниже)
statusId	Integer	ИД статуса заказа (таблица статусов ниже)
mdt	String	Дата доставки
sysId	Integer	ИД системы, в которой был создан заказ (1 - интернет магазин, 8 - API)
sysName	String	Название системы, в которой был создан заказ
eoid	Integer	ИД заказа в вашей системе, если был передан в addGoodsToOrder.
arTovs	Array	Массив с товарными строками заказа. Описание ниже.
Товарные строки
eid	Integer	ИД товарной строки заказа в вашей системе. Если не был передан при добавлении товара, то будет сгенерен автоматически.
gid	String	Составной ИД товара. Параметр, который передается в addGoodsToOrder.
tovid	Integer	ИД товара
brand	String	Бренд
nr	String	Артикул
tovname	String	Название товара
k1	Integer	Заказанное кол-во
k2	Integer	Забронированное кол-во
k3	Integer	Итоговое подтверждённое количество в заказе. Меняется в процессе сборки заказа, финальное значение приобретает в статусе заказа "Выдан".
price	Float	Цена
sum	Float	Сумма
gname	String	Страна происхождения
gtd	String	ГТД
packing	Integer	Кратность упаковки
Статусы заказов
Ниже приведены коды и названия статусов заказов.

ИД статуса (statusId)	Название статуса (status)
0	Аннулирован
10	Отправлен на бронирование
20	Забронирован менеджером
30	Подтвержден
50	На комплектации
90	Можно забрать
100	Выдан
Примеры
Массив
XML
Пример успешного ответа. Итоговый массив данных.
array (
  0 =>
  array (
    'did' => 7078605,
    'dtc' => '14.07.2017 12:42:52',
    'nr' => NULL,
    'status' => 'Забронирован',
    'mdt' => '15.07.2017 00:00:00',
    'arTovs' =>
    array (
      0 =>
      array (
        'eid' => 206624697,
        'gid' => '24758303W20',
        'tovid' => 24758303,
        'brand' => 'FIXAR',
        'nr' => 'FK0179',
        'tovname' => 'Шаровая опора L/R перед.',
        'k1' => 1,
        'k2' => 1,
        'k3' => 0,
        'price' => 345.87,
        'sum' => 345.87,
        'gname' => NULL,
        'gtd' => NULL,
        'packing' => 1,
      ),
      1 =>
      array (
        'eid' => 206624698,
        'gid' => '143431W20',
        'tovid' => 143431,
        'brand' => 'KNECHT',
        'nr' => 'OC47',
        'tovname' => 'Фильтр масляный',
        'k1' => 1,
        'k2' => 1,
        'k3' => 0,
        'price' => 0,
        'gname' => NULL,
        'gtd' => NULL,
        'packing' => 1,
      ),
    ),
  ),
)



https://api.forum-auto.ru/docs/cancelorder.php
Аннулирование заказа. Метод cancelOrder.
Имя метода
cancelOrder
Описание
Отмена заказа. Без возможности восстановления.

Ниже приведено описание параметров.

Входные данные
Параметр	Тип	Описание
login	String	Логин
pass	String	Пароль
did	Integer	ИД заказа, который нужно аннулировать
Результирующие данные.
Параметр	Тип	Описание
did	Integer	ИД заказа
status	Integer	Статус операции. 1 - в случае успешного аннулирования заказа
statusMess	String	Сообщение
Примеры
Массив
XML
Пример успешного ответа. Итоговый массив данных.
array (
  'did' => '7078605',
  'status' => 1,
  'statusMess' => 'Заказ аннулирован',
)
                        



https://api.forum-auto.ru/docs/listgoods.php
Получение списка товара. Метод listGoods.

Внимание
Полный функционал этого метода доступен в следующие после получения логина-пароля сутки.

Имя метода
listGoods
Описание
Возвращает список товара по артикулу.

Существует ограничение на максимальное кол-во запросов в минуту. При превышении данного лимита, сервис возвращает ошибку (код=5).

Ниже приведено описание параметров.

Входные данные
Параметр	Тип	Описание
login	String	Логин
pass	String	Пароль
art	String	Артикул товара. Служебные символы будут удалены, регистр не имеет значения.
cross	Integer	Кроссы товара. Необязательное поле, возможные значения: 0/1. Если 1, то будут возвращены кроссы (аналоги) товара.
br	String	Название бренда. Необязательное поле. Служебные символы будут удалены, регистр не имеет значения. Если поле не пустое, то поиск товара будет происходить только по указанному бренду. Кроссы найденного товара ищутся стандартно - по всем брендам (если были запрошены).
gid	String	ИД товара в нашей системе. Необязательное поле. Если это поле не пустое, то поиск товара будет происходить только по данному ИД без учета полей: артикул (art), кросс (cross), бренд (br). Обратите внимание: теперь это текстовое поле!
Результирующие данные (многомерный массив).
Параметр	Тип	Описание
gid	String	ИД товара в нашей системе. Обратите внимание: теперь это текстовое поле!
brand	String	Название бренда
art	String	Артикул товара
name	String	Наименование товара
d_deliv	Integer	Кол-во дней доставки
h_deliv	Integer	Кол-во часов доставки
kr	Integer	Кратность товара. Кол-во заказываемого товара должно быть кратно этому значению
num	Integer	Доступное кол-во товара
price	float	Цена
whse	String	Склад
is_returnable	Integer	Возможен ли возврат товара (0/1)
Примеры
Массив
XML
Пример успешного ответа. Итоговый массив данных.
array (
  0 =>
  array (
    'gid' => 143431W20,
    'brand' => 'KNECHT',
    'art' => 'OC47',
    'name' => 'Фильтр масляный',
    'd_deliv' => 1,
    'kr' => 1,
    'num' => 30,
    'price' => '194.04',
    'whse' => 'MSK',
    'is_returnable' => 1,
  ),
  1 =>
  array (
    'gid' => 25355541W117227,
    'brand' => 'MAHLE',
    'art' => 'OC 47',
    'name' => 'Фильтр масляный',
    'd_deliv' => 2,
    'kr' => 1,
    'num' => 9,
    'price' => '212.01',
    'is_returnable' => 1,
  ),
)



https://api.forum-auto.ru/docs/listbrands.php
Получение списка брендов. Метод listBrands.
Имя метода
listBrands
Описание
Возвращает список названий брендов по артикулу.

Существует ограничение на максимальное кол-во запросов в минуту. При превышении данного лимита, сервис возвращает ошибку (код=5).

Ниже приведено описание параметров.

Входные данные
Параметр	Тип	Описание
login	String	Логин
pass	String	Пароль
art	String	Артикул товара. Служебные символы будут удалены, регистр не имеет значения.
Результирующие данные (многомерный массив).
Параметр	Тип	Описание
art	String	Запрашиваемый артикул товара
brand	String	Название бренда
Примеры
Массив
XML
Пример успешного ответа. Итоговый массив данных.
array (
  0 =>
  array (
    'art' => 'OC47',
    'brand' => 'METAL LEVE',
  ),
  1 =>
  array (
    'art' => 'OC47',
    'brand' => 'FILTRON',
  ),
  2 =>
  array (
    'art' => 'OC47',
    'brand' => 'KNECHT',
  ),
  3 =>
  array (
    'art' => 'OC47',
    'brand' => 'MAHLE',
  ),
)



https://api.forum-auto.ru/docs/errors.phpоды ошибок
Код	Описание	Примечание
0	Веб-сервис в данный момент не доступен.	Пожалуйста, попробуйте позже.
1	Нарушение типа передаваемой переменной.	Проверьте передаваемые данные.
2	Метод не найден.	В запрос необходимо добавить название метода и параметры (см. документацию).
5	Превышено максимально разрешенное кол-во запросов в минуту.	Кол-во запросов за последнюю минуту: '...'
6	Превышено максимально разрешенное кол-во запросов в сутки.	Кол-во запросов за последние 24 часа: '...'
10	Неверный логин/пароль пользователя.	Клиент, с такой комбинацией логин/пароль не найден в системе. Проверьте передаваемые данные.
11	Доступ к сервису запрещен.	Клиент найден в системе, но нет разрешения для выполнения данной операции.
12	Вы заблокированы, свяжитесь с менеджером.	Блокировка или по финансам, или по решению менеджера.
13	Превышен доступный лимит.	Сумма заказа превышает сумму, на которую Вы можете заказать товар.
20	Товар не найден.	Проверьте ИД товара.
21	Заказ не найден.	Проверьте номер заказа.
22	Статус документа '...'. Заказ аннулировать не возможно.	Аннулирование заказов разрешено только до статуса "подтвержден".
23	Заказ аннулировать не удалось.	Попробуйте еще раз, либо обратитесь к Вашему менеджеру.
24	Заказ уже аннулирован.	
25	Ошибка при создании заказа.	Попробуйте еще раз, либо обратитесь к Вашему менеджеру.
26	Активные заказы не найдены.	Для просмотра выданного или аннулированного заказа, передайте его номер.
27	Товары не найдены.	К сожалению, поиск не дал положительных результатов.
28	Неверное кол-во товара.	Количество должно быть не меньше кратности упаковки.
29	Неверный eid или tid.	С таким eid в заказе найден другой товар.
30	В заказе есть позиции, которые не забронированы, либо забронированы частично.	Пожалуйста, проверьте заказ.
31	Предложение по товару устарело.	Воспользуйтесь методом listGoods, чтобы получить новое предложение по данному товару.

https://api.forum-auto.ru/docs/examplephp.php

Пример работы с веб-сервисом на PHP.
Пример взаимодействия с использованием класса SoapClient.

В приведенном ниже коде, вызывается метод listOrders, для получения информации по заказу.

                    
<?php

// Инициализация SOAP-клиента

$client = new SoapClient('https://api.forum-auto.ru/wsdl', ["exceptions" => false]);

// Выполнение запроса к серверу API Форум-Авто

$result = $client->listOrders($login, $pass, $did);

if (is_soap_fault($result)) {

    // Обработка ошибки

    echo "SOAP Fault: (faultcode: {$result->faultcode}, faultstring: {$result->faultstring}, detail: {$result->detail})";

} else {

    // Результат запроса

    echo '<pre>' . var_export($result, true) . '</pre>';

}

}
                

Если вы хотите ловить исключения, установите "exceptions" => true:

                    
<?php

// Инициализация SOAP-клиента

$client = new SoapClient('https://api.forum-auto.ru/wsdl', ["exceptions" => true]);

try{

    // Выполнение запроса к серверу API Форум-Авто

    $result = $client->listOrders($login, $pass, $did);

    // Результат запроса

    echo '<pre>' . var_export($result, true) . '</pre>';

} catch (SoapFault $e) {

    echo "Exception: (faultcode: {$e->faultcode}, faultstring: {$e->faultstring}, detail: {$e->detail})";

}





                

